<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="FocusPad - Simple note-taking app with minimalist design">
  <meta name="author" content="MK"> <!-- Less egotistic than full name xD-->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <!-- Security headers -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="X-Frame-Options" content="DENY">
  <meta name="referrer" content="strict-origin-when-cross-origin">
  
  <title>{% block title %}FocusPad{% endblock %}</title>
  
  <!-- Prevent theme flash -->
  <script>
    (function() {
      try {
        const theme = localStorage.getItem('theme');
        if (theme === 'dark') {
          document.documentElement.classList.add('dark-theme');
        }
      } catch (e) {
        console.warn('localStorage not available');
      }
    })();
  </script>
  
  <!-- Custom styles only -->
  <link href="{{ url_for('static', filename='style.css') }}" rel="stylesheet">
</head>

<body>
  {% block content %}{% endblock %}
  
  <!-- Theme toggle -->
  <button id="themeToggle" aria-label="Toggle dark mode" aria-pressed="false">ðŸŒž</button>
  
  <noscript>
    <style>
      #themeToggle { display: none; }
    </style>
  </noscript>
  
  <script>
    (function() {
      const toggle = document.getElementById('themeToggle');
      if (!toggle) return;
      
      function setTheme(theme) {
        const isDark = theme === 'dark';
        const root = document.documentElement;
        
        if (isDark) {
          root.classList.add('dark-theme');
          toggle.innerText = 'ðŸŒ™';
          toggle.setAttribute('aria-pressed', 'true');
        } else {
          root.classList.remove('dark-theme');
          toggle.innerText = 'ðŸŒž';
          toggle.setAttribute('aria-pressed', 'false');
        }
        
        try {
          localStorage.setItem('theme', theme);
        } catch (e) {
          console.warn('Could not save theme preference');
        }
      }
      
      toggle.addEventListener('click', function() {
        const current = document.documentElement.classList.contains('dark-theme') ? 'light' : 'dark';
        setTheme(current);
      });
      
      // Set initial state
      let saved = 'light';
      try {
        saved = localStorage.getItem('theme') || 'light';
      } catch (e) {
        console.warn('Could not read theme preference');
      }
      setTheme(saved);
    })();
  </script>
</body>
</html>